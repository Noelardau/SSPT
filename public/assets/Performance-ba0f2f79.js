import{a as s,e as C,w as l,b as n,I as g,u as t,p as A,a_ as K,j as f,v as R,c as h,d as w,s as E,h as k,V as b,k as M,r as _,g as m,F as L,o as z,z as x,S as J,y as O,f as D,a$ as q,n as G}from"./index-af6e56f7.js";import{a as $}from"./index-dad84dab.js";import{a as H,V as Q}from"./VRow-b1dab5a0.js";import{V as I,a as W}from"./VTextField-87230c4f.js";import"./_commonjsHelpers-39b5b250.js";let B=y=>y.length==0?1:y[y.length-1]._id+1;const X={key:0,style:{color:"red"}},Y={key:0},Z={__name:"Note",props:{note:Object},emits:["annulerNote","retirerPrendre"],setup(y,{emit:v}){const e=y;let i=p=>v("annulerNote",p),u=p=>{v("retirerPrendre",p)};return(p,c)=>(s(),C(b,{"max-width":"200"},{default:l(()=>[n(g,{icon:"mdi-close",color:"red",onClick:c[0]||(c[0]=d=>t(i)(t(e).note._id))}),t(e).penalite?w("",!0):(s(),C(A,{key:0,class:K(t(e).note.retenu?"pris":"nonPris")},{default:l(()=>[f(R(t(e).note.note)+" ",1),t(e).note.penalite?(s(),h("span",X,"(Penalité)")):w("",!0)]),_:1},8,["class"])),n(E,{center:""},{default:l(()=>[t(e).note.penalite?w("",!0):(s(),h("div",Y,[t(e).note.retenu?(s(),C(k,{key:0,color:"red",onClick:c[1]||(c[1]=d=>t(u)(t(e).note._id))},{default:l(()=>[f("Retirer")]),_:1})):(s(),C(k,{key:1,color:"green",onClick:c[2]||(c[2]=d=>t(u)(t(e).note._id))},{default:l(()=>[f("Prendre")]),_:1}))]))]),_:1})]),_:1}))}},ee={class:"text-h4"},te={__name:"Timer",emits:["updateTime"],setup(y,{emit:v}){let e=M({h:0,min:0,sec:0}),i=()=>{p.value=`${e.h<10?"0"+e.h:e.h}:${e.min<10?"0"+e.min:e.min}:${e.sec<10?"0"+e.sec:e.sec}`},u=_(!1),p=_(`${e.h<10?"0"+e.h:e.h}:${e.min<10?"0"+e.min:e.min}:${e.sec<10?"0"+e.sec:e.sec}`),c=null,d=()=>{u.value=!0,c=setInterval(()=>{e.sec++,e.sec>59&&(e.sec=0,e.min++),i(),v("updateTime",p.value)},1e3)},a=()=>{u.value=!1,clearInterval(c)},N=()=>{a(),e.h=0,e.min=0,e.sec=0,i()};return(T,F)=>(s(),h(L,null,[m("div",ee,R(t(p)),1),n(k,{onClick:t(N)},{default:l(()=>[n(g,{icon:"mdi-restart"})]),_:1},8,["onClick"]),t(u)?(s(),C(k,{key:1,onClick:t(a)},{default:l(()=>[n(g,{icon:"mdi-pause"})]),_:1},8,["onClick"])):(s(),C(k,{key:0,onClick:t(d)},{default:l(()=>[n(g,{icon:"mdi-play"})]),_:1},8,["onClick"]))],64))}},ne={key:0,align:"center"},le={class:"text-h4"},ae=m("br",null,null,-1),oe={key:0,class:"text-h8 text-red"},re={key:1,class:"text-h8 text-blue"},se=m("br",null,null,-1),ie=m("br",null,null,-1),ue=m("br",null,null,-1),de=m("br",null,null,-1),ce={key:1},he={__name:"Performance",setup(y){$.defaults.baseURL="http://localhost:5000",z(()=>{$.get("/api.poete/findOne/"+x().params.idPoete).then(o=>{e.value=o.data.body}),$.get("/api.tournoi/get/"+x().params.idTournoi).then(o=>{i.value=o.data,a.value._id=B(i.value.performances)})});let v=_(!0);var e=_({}),i=_({});_(0);let u=_(!1),p=()=>u.value=!u.value,c=J(()=>!!u.value),d=_({note:null,retenu:!0,penalite:c}),a=_({notes:[],idPoete:parseInt(x().params.idPoete)}),N=o=>{a.value.duree=o},T=()=>{if(d.value.note!=null){var o={_id:B(a.value.notes),note:d.value.note,retenu:d.value.retenu,penalite:d.value.penalite};o.penalite?a.value.notes=[...a.value.notes,o]:a.value.notes.filter(r=>r.penalite==!1).length<i.value.nbJury&&(a.value.notes=[...a.value.notes,o])}d.value.note=null},F=o=>{a.value.notes=a.value.notes.filter(r=>r._id!=o)},S=o=>{a.value.notes.forEach(r=>{r._id==o&&(r.retenu=!r.retenu)})},U=o=>{let r=0;return o.forEach(V=>{V.retenu&&(V.penalite?r-=parseFloat(V.note):r+=parseFloat(V.note))}),r},j=()=>{a.value.notes.filter(o=>!o.penalite).length==i.value.nbJury?(a.value.noteFinal=U(a.value.notes),console.log(a.value),i.value.performances=[...i.value.performances,a.value],console.log(i.value.performances),v.value=!v.value,$.post("/api.tournoi/update",i.value).then(o=>console.log(o.data))):alert("Metter les notes!!!!")};return(o,r)=>{const V=O("RouterLink");return t(v)?(s(),h("div",ne,[m("div",null,[n(b,null,{default:l(()=>[m("h1",le,R(t(e).pseudoPoete),1),n(I,null,{default:l(()=>[n(te,{onUpdateTime:t(N)},null,8,["onUpdateTime"])]),_:1})]),_:1}),ae,n(b,{"max-width":"300"},{default:l(()=>[n(I,{onSubmit:r[1]||(r[1]=D(()=>{},["prevent"]))},{default:l(()=>[n(W,{label:t(u)?"Pénalité":"Note",type:"number",modelValue:t(d).note,"onUpdate:modelValue":r[0]||(r[0]=P=>t(d).note=P),onKeypress:q(t(T),["enter"])},null,8,["label","modelValue","onKeypress"]),n(k,{onClick:t(T)},{default:l(()=>[f("Ajouter")]),_:1},8,["onClick"])]),_:1}),m("div",{style:{"margin-top":"20px",cursor:"pointer"},onClick:r[2]||(r[2]=P=>t(p)())},[t(u)?(s(),h("span",re,"Note?")):(s(),h("span",oe,"Penalité?"))])]),_:1}),f(),se,ie,n(H,null,{default:l(()=>[(s(!0),h(L,null,G(t(a).notes,P=>(s(),C(Q,null,{default:l(()=>[n(Z,{note:P,onAnnulerNote:t(F),onRetirerPrendre:t(S)},null,8,["note","onAnnulerNote","onRetirerPrendre"])]),_:2},1024))),256))]),_:1}),ue,de,n(k,{color:"primary",onClick:t(j)},{default:l(()=>[f(" Enregistrer")]),_:1},8,["onClick"])])])):(s(),h("div",ce,[n(b,null,{default:l(()=>[n(A,null,{default:l(()=>[f("Performance enregistrée!!!")]),_:1}),n(E,{center:""},{default:l(()=>[n(k,{color:"primary"},{default:l(()=>[n(g,{icon:"mdi-arrow-left"}),n(V,{to:{name:"listParticipants",params:{idTournoi:t(x)().params.idTournoi}}},{default:l(()=>[f(" Revenir à la liste des participants")]),_:1},8,["to"])]),_:1})]),_:1})]),_:1})]))}}};export{he as default};
